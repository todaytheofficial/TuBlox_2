<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TuBlox Studio</title>
    <link rel="stylesheet" href="css/studio.css">
    <style>
        /* –°—Ç–∏–ª–∏ –¥–ª—è TuModels –≤–∫–ª–∞–¥–∫–∏ */
        .models-tab-content {
            display: none;
        }
        
        .models-tab-content.active {
            display: block;
        }
        
        .models-library {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 10px;
            max-height: 300px;
            overflow-y: auto;
            padding: 10px;
            background: var(--studio-panel);
            border-radius: var(--studio-radius-sm);
            margin-bottom: 15px;
        }
        
        .model-item {
            background: var(--studio-surface);
            border: 1px solid var(--studio-border);
            border-radius: var(--studio-radius-sm);
            padding: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .model-item:hover {
            background: var(--studio-hover);
            border-color: var(--studio-primary);
            transform: translateY(-2px);
        }
        
        .model-item.active {
            background: rgba(88, 101, 242, 0.2);
            border-color: var(--studio-primary);
        }
        
        .model-icon {
            width: 40px;
            height: 40px;
            margin: 0 auto 5px;
            background: var(--studio-bg);
            border-radius: var(--studio-radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }
        
        .model-name {
            font-size: 0.7rem;
            color: var(--studio-text);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .empty-library {
            text-align: center;
            padding: 30px 20px;
            color: var(--studio-text-dim);
            grid-column: 1 / -1;
        }
        
        .empty-library h4 {
            margin: 10px 0 5px 0;
            color: var(--studio-text);
        }
        
        .model-tools {
            display: flex;
            gap: 8px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .model-tool {
            background: var(--studio-panel);
            border: 1px solid var(--studio-border);
            color: var(--studio-text);
            padding: 6px 10px;
            border-radius: var(--studio-radius-sm);
            cursor: pointer;
            font-size: 0.75rem;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: all 0.2s ease;
        }
        
        .model-tool:hover {
            background: var(--studio-hover);
            border-color: var(--studio-primary);
        }
        
        .model-tool.active {
            background: var(--studio-primary);
            border-color: var(--studio-primary);
            color: white;
        }
        
        .model-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 15px 0;
        }
        
        .model-stat {
            background: var(--studio-bg);
            border: 1px solid var(--studio-border);
            border-radius: var(--studio-radius-sm);
            padding: 8px;
            text-align: center;
        }
        
        .model-stat-value {
            font-size: 1rem;
            font-weight: 700;
            color: var(--studio-accent);
            margin-bottom: 2px;
        }
        
        .model-stat-label {
            font-size: 0.65rem;
            color: var(--studio-text-dim);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .model-save-btn {
            width: 100%;
            margin-top: 15px;
            background: var(--studio-accent);
            color: #000;
            font-weight: 700;
            border: none;
        }
        
        .model-save-btn:hover {
            background: var(--studio-accent);
            opacity: 0.9;
        }
        
        .model-preview {
            width: 100%;
            height: 150px;
            background: var(--studio-bg);
            border-radius: var(--studio-radius-sm);
            border: 1px solid var(--studio-border);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }
        
        .model-preview canvas {
            width: 100%;
            height: 100%;
            display: block;
        }
        
        .preview-empty {
            color: var(--studio-text-dim);
            font-size: 0.875rem;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="ribbon">
        <b>TuBlox Studio</b>
        <div style="width:1px; height:20px; background:#555; margin:0 10px;"></div>
        <button onclick="switchTab('build')">üèóÔ∏è Build</button>
        <button onclick="switchTab('models')">üì¶ Models</button>
        <div style="flex:1"></div>
        <button id="save-btn" class="btn-primary" style="width: auto; padding: 8px 20px;">üíæ Save</button>
        <button onclick="location.href='index.html'" style="background:var(--danger); border-color:var(--danger);">Exit</button>
    </div>

    <div class="workspace">
        <canvas id="gameCanvas"></canvas>
        <div class="sidebar">
            <!-- Build Tab -->
            <div id="build-tab" class="models-tab-content active">
                <div class="panel-header">Build Tools</div>
                <div class="content">
                    <div class="model-tools">
                        <button class="model-tool active" onclick="setBuildTool('part')">‚óª Part</button>
                        <button class="model-tool" onclick="setBuildTool('spawn')">üöÄ Spawn</button>
                        <button class="model-tool" onclick="setBuildTool('text')">üìù Text</button>
                    </div>
                    
                    <div id="explorer-list" class="content"></div>
                </div>
                <div class="panel-header">Properties</div>
                <div id="properties-panel" class="content">
                    <p style="color:#666; text-align:center; margin-top:20px;">Select an object</p>
                </div>
            </div>
            
            <!-- Models Tab -->
            <div id="models-tab" class="models-tab-content">
                <div class="panel-header">Model Library</div>
                <div class="content">
                    <div class="model-tools">
                        <button class="model-tool" onclick="newModel()">+ New</button>
                        <button class="model-tool" onclick="importModel()">üìÅ Import</button>
                        <button class="model-tool" onclick="exportCurrentModel()">üì§ Export</button>
                    </div>
                    
                    <div id="models-library" class="models-library">
                        <div class="empty-library">
                            <div style="font-size: 32px; margin-bottom: 10px;">üì¶</div>
                            <h4>No Models Yet</h4>
                            <p style="font-size: 0.75rem;">Create your first model!</p>
                        </div>
                    </div>
                    
                    <div class="model-preview">
                        <div class="preview-empty">
                            <div style="font-size: 24px; margin-bottom: 10px;">üëÅÔ∏è</div>
                            Select a model to preview
                        </div>
                        <canvas id="modelPreviewCanvas" style="display: none;"></canvas>
                    </div>
                    
                    <div class="model-stats">
                        <div class="model-stat">
                            <div class="model-stat-value" id="parts-count">0</div>
                            <div class="model-stat-label">Parts</div>
                        </div>
                        <div class="model-stat">
                            <div class="model-stat-value" id="size-value">0x0</div>
                            <div class="model-stat-label">Size</div>
                        </div>
                    </div>
                    
                    <button class="btn-primary model-save-btn" onclick="saveModel()">üíæ Save to Library</button>
                </div>
            </div>
        </div>
    </div>

    <div id="context-menu">
        <button class="ctx-btn" onclick="openTextEditor()">üìù Add / Edit Text</button>
        <button class="ctx-btn delete" onclick="deleteObj()">üóë Delete</button>
    </div>

    <div id="text-modal-overlay">
        <div class="text-modal">
            <h3>Edit Text</h3>
            <label>Content</label>
            <input type="text" id="modal-text-input" placeholder="Type something..." oninput="updateFontPreview()">
            <label>Font Style</label>
            <select id="modal-font-select" onchange="updateFontPreview()">
                <option value="Arial">Arial (Default)</option>
                <option value="Fredoka">Fredoka (Round)</option>
                <option value="Quicksand">Quicksand (Clean)</option>
                <option value="Bangers">Bangers (Comic)</option>
                <option value="Orbitron">Orbitron (Sci-Fi)</option>
                <option value="Patrick Hand">Patrick Hand (Handwritten)</option>
                <option value="Courier New">Courier New (Code)</option>
                <option value="Times New Roman">Times New Roman (Serif)</option>
            </select>
            <div id="font-preview-box" class="font-preview">Preview</div>
            <div style="display:flex; gap:10px; margin-top:20px;">
                <button class="btn-primary" onclick="applyText()">Apply</button>
                <button class="btn-primary" style="background:#444; box-shadow:0 5px 0 #222;" onclick="closeTextModal()">Cancel</button>
            </div>
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script src="studio.js"></script>
</body>
</html>